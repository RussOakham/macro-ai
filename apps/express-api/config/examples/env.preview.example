# Preview Environment Variables (GitHub Actions)
# This file contains preview environment variables for GitHub Actions PR deployments
# These are used when GITHUB_ACTIONS=true and a PR is opened/updated
# The NEON_BRANCH_NAME is dynamically set by the GitHub workflow

# Preview Environment Configuration
NODE_ENV=production
APP_ENV=preview
SERVER_PORT=3040

# GitHub Actions Information (Set automatically by workflow)
BRANCH_NAME=${GITHUB_HEAD_REF}
PR_NUMBER=${GITHUB_EVENT_NUMBER}
GITHUB_ACTIONS=true
GITHUB_RUN_ID=${GITHUB_RUN_ID}
GITHUB_RUN_NUMBER=${GITHUB_RUN_NUMBER}

# Database Configuration (GitHub Actions PR Branch)
# NEON_BRANCH_NAME is set by the workflow: preview/pr-{number}
RELATIONAL_DATABASE_URL=postgresql://user_placeholder:password_placeholder@ep-preview-placeholder.us-east-1.aws.neon.tech/database_placeholder?channel_binding=require&sslmode=require&branch=${NEON_BRANCH_NAME}

# Redis Configuration (Shared Preview Redis)
REDIS_URL=redis://default:***@global-macro-ai-preview-redis.upstash.io:6379

# AWS Cognito Configuration (Shared with staging for testing)
AWS_COGNITO_REGION=us-east-1
AWS_COGNITO_USER_POOL_ID=${AWS_COGNITO_USER_POOL_ID}
AWS_COGNITO_USER_POOL_CLIENT_ID=${AWS_COGNITO_USER_POOL_CLIENT_ID}
AWS_COGNITO_REFRESH_TOKEN_EXPIRY=30

# Cookie Settings (Preview domain)
COOKIE_DOMAIN=preview-pr-${PR_NUMBER}.macro-ai.russoakham.dev
COOKIE_ENCRYPTION_KEY=${COOKIE_ENCRYPTION_KEY}

# API Configuration (Preview API key)
API_KEY=${PREVIEW_API_KEY}

# OpenAI Configuration (Use preview API key with lower limits)
OPENAI_API_KEY=${OPENAI_PREVIEW_API_KEY}

# Rate Limiting Configuration (Relaxed for testing)
RATE_LIMIT_WINDOW_MS=900000
RATE_LIMIT_MAX_REQUESTS=500
AUTH_RATE_LIMIT_WINDOW_MS=3600000
AUTH_RATE_LIMIT_MAX_REQUESTS=50
API_RATE_LIMIT_WINDOW_MS=60000
API_RATE_LIMIT_MAX_REQUESTS=100

# CORS Configuration (Allow preview domains)
CORS_ALLOWED_ORIGINS=https://preview-pr-${PR_NUMBER}.macro-ai.russoakham.dev,https://preview-api-pr-${PR_NUMBER}.macro-ai.russoakham.dev

# Monitoring (Preview has detailed logging for debugging)
LOG_LEVEL=debug
ENABLE_DETAILED_LOGGING=true
ENABLE_ERROR_REPORTING=true

# Preview-specific settings
PREVIEW_MODE=true
ALLOW_TEST_DATA=true
DISABLE_EMAIL_NOTIFICATIONS=true
